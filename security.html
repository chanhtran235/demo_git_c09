<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Spring Security Filter Chain</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #fff;
            padding: 2rem;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
        }

        .filter-card {
            margin-bottom: .3rem;
        }

        .arrow-down {
            text-align: center;
            font-size: 1.5rem;
            color: #6c757d;
            margin: .1rem 0;
        }

        .final-step {
            text-align: center;
            font-weight: 600;
            border: 1px solid #ccc;
            border-radius: .5rem;
            padding: 1rem;
            background: #f8f9fa;
        }

        .card-header {
            cursor: pointer;
            background-color: #e8f5e9;
        }

        .card-header:hover {
            background-color: #d0ebd0;
        }

        ul li {
            font-size: small;
            color: red;
        }
    </style>
</head>
<body>

<div class="container w-50">
    <!-- Client Card -->
    <div class="card filter-card border-primary">
        <div class="card-header bg-primary text-white">
            <strong>[ Client ]</strong>
        </div>
        <div class="card-body">
            <ul class="mb-0">
                <li>‚ë† <code>POST /login</code> (username, password) ‚Üê <strong>Form Login</strong></li>
                <li>‚ë° <code>Authorization: Bearer &lt;JWT token&gt;</code> ‚Üê <strong>JWT</strong></li>
                <li>‚ë¢ <code>Authorization: Basic base64(user:pass)</code> ‚Üê <strong>HTTP Basic</strong></li>
                <li>‚ë£ <code>Redirect to /oauth2/authorization/google</code> ‚Üê <strong>OAuth2</strong></li>
            </ul>
        </div>
    </div>

    <div class="arrow-down"><i class="bi bi-arrow-down-circle"></i></div>

    <div class=" card-header border-primary bg-warning text-white mb-2 py-2">
        <strong data-bs-toggle="collapse" data-bs-target="#filterChain" style="cursor:pointer;">üîê SPRING SECURITY FILTER
            CHAIN</strong>
    </div>

    <div id="filterChain" class="collapse show py-0">
        <!-- C√°c filter -->
        <div class="card filter-card py-1">
            <div class="card-header py-0 " data-bs-toggle="collapse" data-bs-target="#f1">
                <strong>1Ô∏è‚É£ SecurityContextPersistenceFilter</strong>
            </div>
            <div id="f1" class="collapse show">
                <div class="card-body py-0">
                    <ul class="my-0 py-0">
                        <li>L·∫•y SecurityContext t·ª´ session (Form/Session)</li>
                        <li>Ho·∫∑c ƒë·ªÉ tr·ªëng (JWT, Basic, OAuth2 s·∫Ω ƒëi qua c√°c filter kh√°c)</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="arrow-down my-0"><i class="bi bi-arrow-down-circle"></i></div>
        <div class="card filter-card">
            <div class="card-header py-0" data-bs-toggle="collapse" data-bs-target="#f2"><strong>2Ô∏è‚É£
                UsernamePasswordAuthenticationFilter</strong></div>
            <div id="f2" class="collapse">
                <div class="card-body">
                    <ul class="my-0 py-0">
                        <li>ƒê·ªçc form <code>/login</code> (Form Login)</li>
                        <li>G·ªçi DaoAuthenticationProvider ‚Üí UserDetailsService</li>
                        <li>Ki·ªÉm tra Database (user, password hash)</li>
                        <li>Sinh Authentication object (success)</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="arrow-down"><i class="bi bi-arrow-down-circle"></i></div>
  

        <div class="card filter-card">
            <div class="card-header py-0" data-bs-toggle="collapse" data-bs-target="#f3">
                <strong>3Ô∏è‚É£ JwtAuthenticationFilter</strong>
                <span class="mx-5 text-warning">(Option)</span>
            </div>
            <div id="f3" class="collapse">
                <div class="card-body">
                    <ul class="my-0 py-0">
                        <li>Ki·ªÉm tra header <code>Authorization: Bearer &lt;token&gt;</code></li>
                        <li>Gi·∫£i m√£ JWT, x√°c th·ª±c ch·ªØ k√Ω, l·∫•y user info</li>
                        <li>ƒê·∫∑t Authentication v√†o SecurityContext</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="arrow-down"><i class="bi bi-arrow-down-circle"></i></div>
        <div class="card filter-card">
            <div class="card-header py-0" data-bs-toggle="collapse" data-bs-target="#f4"><strong>4Ô∏è‚É£
                BasicAuthenticationFilter</strong>
                <span class="mx-5 text-warning">(Option)</span>
            </div>
            <div id="f4" class="collapse">
                <div class="card-body">
                    <ul class="my-0 py-0">
                        <li>Ki·ªÉm tra header <code>Authorization: Basic &lt;base64&gt;</code></li>
                        <li>Gi·∫£i m√£ user:pass ‚Üí G·ªçi UserDetailsService</li>
                        <li>Sinh Authentication object</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="arrow-down"><i class="bi bi-arrow-down-circle"></i></div>
        <div class="card filter-card">
            <div class="card-header py-0" data-bs-toggle="collapse" data-bs-target="#f5"><strong>5Ô∏è‚É£
                OAuth2LoginAuthenticationFilter</strong>
                <span class="mx-0 text-warning">(Option)</span>
            </div>
            <div id="f5" class="collapse">
                <div class="card-body">
                    <ul class="my-0 py-0">
                        <li>Nh·∫≠n callback t·ª´ provider (Google, Facebook...)</li>
                        <li>G·ªçi OAuth2UserService ‚Üí T·∫°o/ƒêƒÉng nh·∫≠p user</li>
                        <li>Sinh Authentication (OAuth2AuthenticationToken)</li>
                    </ul>
                </div>
            </div>
        </div>


        <div class="arrow-down"><i class="bi bi-arrow-down-circle"></i></div>
        <div class="card filter-card">
            <div class="card-header py-0" data-bs-toggle="collapse" data-bs-target="#f6"><strong>6Ô∏è‚É£
                SessionManagementFilter</strong></div>
            <div id="f6" class="collapse">
                <div class="card-body">
                    <ul class="my-0 py-0">
                        <li>L∆∞u user v√†o session (n·∫øu c√≥)</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="arrow-down"><i class="bi bi-arrow-down-circle"></i></div>
        <div class="card filter-card">
            <div class="card-header py-0" data-bs-toggle="collapse" data-bs-target="#f7"><strong>7Ô∏è‚É£
                ExceptionTranslationFilter</strong></div>
            <div id="f7" class="collapse">
                <div class="card-body">
                    <ul class="my-0 py-0">
                        <li>B·∫Øt l·ªói <code>AuthenticationException</code> / <code>AccessDeniedException</code></li>
                        <li>Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang login ho·∫∑c tr·∫£ JSON 401/403</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="arrow-down"><i class="bi bi-arrow-down-circle"></i></div>
        <div class="card filter-card">
            <div class="card-header py-0" data-bs-toggle="collapse" data-bs-target="#f8"><strong>8Ô∏è‚É£
                FilterSecurityInterceptor</strong></div>
            <div id="f8" class="collapse">
                <div class="card-body">
                    <ul class="my-0 py-0">
                        <li>Ki·ªÉm tra quy·ªÅn truy c·∫≠p URL, Role, Authority</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="arrow-down"><i class="bi bi-arrow-down-circle-fill text-success"></i></div>
    <div class="card-header bg-primary text-white final-step py-1 my-1">[ Dispatcher Servlet (FC) ]</div>
    <div class="card-header bg-primary text-white final-step py-1 my-1">[ Controller /home ho·∫∑c /api/... ]</div>
    <div class="card-header bg-primary text-white final-step py-1 my-1 ">(session gi·ªØ SecurityContext ho·∫∑c JWT ƒë√≠nh k√®m
        request)
    </div>
    <div class=" card-header bg-primary text-white final-step py-1 my-1">[ Response HTML view ho·∫∑c JSON response ]</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
